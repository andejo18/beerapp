{{extend 'layout.html'}}
  <script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?libraries=places&sensor=true"></script>
  <script>


    var map;

    function success(position) {
      var mapcanvas = document.createElement('div');
      mapcanvas.id = 'mapcontainer';
      mapcanvas.style.height = '400px';
      mapcanvas.style.width = '600px';
      document.getElementById('mapSpot').appendChild(mapcanvas);
      //var coords = new google.maps.LatLng(position.coords.latitude, position.coords.longitude);
      var coords = new google.maps.LatLng(43.0731, -89.4011);
      var options = {
        zoom: 13,
        center: coords,
        mapTypeControl: false,
        navigationControlOptions: {
          style: google.maps.NavigationControlStyle.SMALL
        },
        mapTypeId: google.maps.MapTypeId.ROADMAP
      };
      map = new google.maps.Map(document.getElementById("mapcontainer"), options);
      var marker = new google.maps.Marker({
          position: coords,
          map: map,
          title:"You are here!",
      });


      var request = {
        location: coords,
        radius: '500',
        query: 'brewery'
      };

      service = new google.maps.places.PlacesService(map);
      service.textSearch(request, callback);

    }


    function callback(results, status) {
      if (status == google.maps.places.PlacesServiceStatus.OK) {
        for (var i = 0; i < results.length; i++) {
          var place = results[i];
          createMarker(results[i]);
          document.getElementById("breweryList").innerHTML = document.getElementById("breweryList").innerHTML + results[i].name;
        }
      }
    }


    function createMarker(place) {
      var placeLoc = place.geometry.location;

      var marker = new google.maps.Marker({
        map: map,
        position: placeLoc,
        icon:"/beerme/static/images/beer.png",
        title: place.name,
      });

    } 


    
    if (navigator.geolocation) {
      navigator.geolocation.getCurrentPosition(success);
    } else {
      error('Geo Location is not supported');
    }
  </script>


  <div id="mapSpot"/>
  <div id="breweryList"/>